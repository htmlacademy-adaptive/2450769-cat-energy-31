# Описание проекта

## Подготовка окружения

### 1. Терминал

В Linux и macOS он уже есть, а в Windows надо установить _git-bash_, который идёт в комплекте с самим [Git](https://git-scm.com/download/windows).

### 2. Node.js

Лучше устанавливать Node.js через менеджер версий ноды — _nvm_. Для его установки выполни в терминале:

```sh
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
```

Перезапусти терминал и убедись, что _nvm_ работает:

```sh
nvm -v
```

Команда должна вывести версию _nvm_ — `0.39.7`. Если отвечает, что команда не найдена, то выполни эту команду:

```sh
echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.profile && echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> ~/.profile
```

И снова перезапусти терминал и проверь версию _nvm_. Когда выведет версию, можно установить сам _node.js_:

```sh
nvm install --lts --default
```

После этого выполни:

```sh
node -v
```

Команда должна вывести версию _node.js_, например `v20.12.1`, что означает успешность установки.

### 3. Зависимости

Вместе с нодой стал доступен её менеджер пакетов _npm_. Но в проекте используется его альтернатива — _pnpm_. Он по умолчанию отключён, надо включить командой:

```shell
corepack enable pnpm
```

После этого для установки зависимостей проекта в терминале, находясь в директории проекта, выполни:

```shell
pnpm i
```

## Работа с проектом

После установки зависимостей становится доступным любой pnpm-скрипт проекта. Все доступные скрипты можно посмотреть выполнив:

```shell
pnpm run
```

Но для начала достаточно запомнить эти два наиболее часто используемые:

* Линтинг — последовательная проверка кода пятью линтерами:

	```shell
	pnpm lint
	```

* Cборка для разработки, при которой запустится и локальный сервер в папке `build/`, в которую собирается проект из папки `source/`, а в брауезере откроется разрабатываемый сайт и будет обновляться при обновлении файлов в проекте:

	```shell
	pnpm start
	```

## Структура папок проекта

В каждой папке есть `README.md` файл, который имеет более полное описание по работе с папкой

```shell
├── .github/                    # Специальная папка для github
│   └── workflows/              # Автоматизация для github actions
│       ├── check.yml           # Запускает линтеры на Гитхабе
│       ├── gh-pages-on-pr.yml  # Публикует превью проекта из пулреквеста
│       └── gh-pages.yml        # Публикует проект из ветки master
├── source/                     # Исходники проекта
│   ├── favicons/               # Папка для фавиконок (кроме favicon.ico)
│   ├── fonts/                  # Папка для шрифтов
│   ├── icons/                  # Папка для оптимизированных svg-иконок для преобразования их в спрайт (stack)
│   ├── images/                 # Папка для оптимизированных картинок
│   ├── scripts/                # Скрипты
│   │   └── index.js            # Главный скрипт
│   ├── styles/                 # Папка для препроцессорных файлов sass
│   │   ├── blocks/             # Стили БЭМ-блоков
│   │   │   └── header.scss     # Стили для конкретного БЭМ-блока
│   │   ├── common/             # Папка для общих стилей (не БЭМ-блоки)
│   │   │   ├── fonts.scss      # Подключение шрифтов к проекту
│   │   │   ├── global.scss     # Глобальные стили, которые касаются всего проекта
│   │   │   └── variables.scss  # Переменные для всего проекта
│   │   └── styles.scss         # Основной стилевой файл с импортами всех остальных
│   ├── catalog.html            # HTML-файл для страницы каталога
│   ├── data.json               # Папка для сторонних бибилотек
│   ├── favicon.ico             # Папка для сторонних бибилотек
│   ├── index.html              # HTML-файл для главной страницы
│   └── manifest.webmanifest    # Вебманифест с путями до иконок
├── .editorconfig               # Настройки форматирования текстовых файлов
├── .gitignore                  # Настройки игнорирования файлов для git
├── .linthtmlrc                 # Правила для linthtml
├── eslint.config.js            # Правила для eslint
├── gulpfile.js                 # Автоматизация для Gulp
├── package.json                # Зависимости проекта, скрипты, настройки проекта
├── pnpm-lock.yaml              # Зависимости проекта
├── README.md                   # Документация
└── stylelint.config.js         # Правила для stylelint
```

## Основные команды

* `pnpm start` — запускает сборку с сервером для разработки проекта
* `pnpm build` — создаёт папку `build` с оптимизированными файлами для продакшена

## Дополнительные команды

* `pnpm preview` — позволяет посмотреть результат работы prod-версии сборки
* `pnpm lint` — запускает все проверки (занимает длительное время):
	* `pnpm lint:spaces` — проверяет отступы с помощью editorConfig
	* `pnpm lint:markup` — проверяет HTML-разметку через W3C-валидатор
	* `pnpm lint:html` — проверяет разметку по правилам linthtml
	* `pnpm lint:bem` — проверяет правильное использование БЭМ в разметке
	* `pnpm lint:styles` — проверяет проект на совместимость с stylelint
	* `pnpm lint:scripts` — проверяет скрипты по правилам eslint
* `pnpm optimize` — запускает все оптимизации изображений (занимает длительное время):
	* `pnpm optimize:icons` — оптимизирует векторные иконки в `source/icons/`
	* `pnpm optimize:images` — оптимизирует векторные и конвертирует растровые изображения в `source/images/` (оригиналы растровых удаляются автоматически)
	* `pnpm optimize:favicons` — оптимизирует svg-фавиконку в `source/favicons/` и генерирует все необходимые варианты фавиконок, а также вебманифест.

## Работа с разметкой

Все HTML-файлы с разметкой складывайте в папку `source/`.

```shell
└── source/
	├── index.html
	├── catalog.html
	└── form.html
```

Из папки `source/` сборка переносит файлы в папку `build/`.

```shell
└── build/
	├── index.html
	├── catalog.html
	└── form.html
```

## Работа со стилями

Все стили находятся в папке `source/styles/`.

```shell
└── source/
	└── styles/
		├── blocks/
		│	└── header.scss
		├── common/
		│	├── fonts.scss
		│	├── global.scss
		│	└── variables.scss
		└── styles.scss
```

Все БЭМ-блоки и остальные препроцессорные файлы подключайте в `source/styles/styles.scss`:

```scss
/* COMMON */
@import "./common/variables.scss";
@import "./common/global.scss";
@import "./common/fonts.scss";

/* BLOCKS */
@import "./blocks/header.scss";
```

БЭМ-блоки импортируйте в секцию `/* BLOCKS */`.

Все препроцессорные файлы сборка обработает и превратит в `styles.css`. Файл `styles.css` сборка перенесёт в:

```shell
└── build/
	└── styles/
		└── styles.css
```

## Работа с графикой

### Изображения

Из макета всю растровую графику (только с **двухкратной плотностью**, но без суффикса плотности `@2x` в имени) и всю контентную векторную графику (логотип, графики, иллюстрации) складывай в:

```shell
└── source/
	└── images/
```

После добавления оригинальных файлов из макета запускай команду `pnpm optimize:images` для оптимизации векторной и конвертации растровой графики. Команду нужно запускать один раз при появлении новой графики в проекте.

Оптимизированную графику нужно коммитить.

### Иконки

Векторную графику для спрайта (иконки) складывай в:

```shell
└── source/
	└── icons/
```

Запуск команды `pnpm optimize:icons` оптимизирует иконки.

### Фавиконки

Векторную фавиконку (одну со сплошным фоном) размести в:

```shell
└── source/
	└── favicons/
```

Запуск команды `pnpm optimize:favicons` оптимизирует svg-фавиконку и сгенерирует все остальные варианты и вебманифест для них. Например, для исходного файла `source/favicons/icon.svg` результат будет таким:

```shell
└── source/
	└── favicons/
		├── icon-180.png
		├── icon-192.png
		├── icon-512.png
		├── icon.svg
		├── icon.ico
		└── icon.webmanifest
```

Переименуйте ico-файл с вебманифестом и переложите их  в `source/`. Получится примерно так:

```shell
└── source/
	├── favicons/
	│	├── icon-180.png
	│	├── icon-192.png
	│	├── icon-512.png
	│	└── icon.svg
	├── favicon.ico
	└── manifest.webmanifest
```

По необходимости исправь пути в вебманифесте.

### Сборка

При продакшен-сборке автоматизация перенесёт всю графику из `source/images/` в `build/images/`, а из иконок в `source/icons/` создаст спрайт `build/icons/stack.svg`.

**НО!** При сборке для разработки автоматизация собирает только спрайт в `build/icons/`. Папок `favicons` и `images/` внутри `build/` не будет совсем — это нормально, потому что дев-сервер знает, что при запросе этих изображений ему надо смотреть в `source/images/` и `source/images/`, а `favicon.ico` и вебманифест искать в `source/`. Это также относится и шрифтам.

```shell
└── build/
	├── favicons/               # только при продакшен-сборке
	├── fonts/                  # только при продакшен-сборке
	├── icons/                  # при любой сборке
	│   └── stack.svg
	├── images/                 # только при продакшен-сборке
	├── favicon.ico             # только при продакшен-сборке
	└── manifest.webmanifest    # только при продакшен-сборке
```

## Работа со шрифтами

Все шрифтовые файлы лежат в `source/fonts/`. Сборка в при продакшен переносит их в `build/fonts/`.

```shell
└── build/
	└── fonts/
		├──  open-sans.woff2
		└──  open-sans-bold.woff2

```

## Работа со скриптами

Все скрипты лежат в `source/scripts/`.

```shell
└── source/
	└── scripts/
		├── index.js
		└── modal.js
```

Сборка переносит их в `build/scripts/`.

```shell
└── build/
	└── scripts/
		├── index.js
		└── modal.js
```

## Работа со сторонними библиотеками

Для удобства внесения сторонних библиотек в ваш проект, вы можете использовать папку `source/vendor/`. В этой папке вы можете размещать любые файлы, связанные с внешними библиотеками.

Например, предположим, что вы хотите добавить в проект библиотеку, которая включает в себя как стилевой файл `library.css`, так и скрипты `library.js`. Чтобы интегрировать их в ваш проект, следуйте этим шагам:

Положите файлы библиотеки в папку `source/vendor/`, как показано ниже:

```shell
└── source/
	└── vendor/
		├── library.css
		└── library.js
```

Если у вас есть несколько библиотек с разными файлами, вы можете группировать файлы одной библиотеки в ее собственную подпапку. Например:

```shell
└── source/
	└── vendor/
		└── library/
			├── library.css
			└── library.js
```

При сборке вашего проекта, все файлы из папки `source/vendor/` будут включены в папку `build/vendor/`, сохраняя их структуру. Например:

```shell
└── build/
	└── vendor/
		└── library/
			├── library.css
			└── library.js
```

Таким образом, вы можете удобно организовать и внедрить сторонние библиотеки в ваш проект, сохраняя их структуру в папке `source/vendor/`.
